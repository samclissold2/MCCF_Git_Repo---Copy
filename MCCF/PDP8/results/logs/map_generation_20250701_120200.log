2025-07-01 12:02:00 - INFO - setup_logging - Logging initialized. Log file: C:\Users\SamClissold\MCCF_Git_Repo\MCCF\PDP8\results\logs\map_generation_20250701_120200.log
2025-07-01 12:02:00 - INFO - main - Starting map generation process
2025-07-01 12:02:00 - INFO - main - Generating map type: all
2025-07-01 12:02:00 - INFO - main - Generating power project map
2025-07-01 12:02:00 - INFO - read_and_clean_power_data - Starting power data reading and cleaning
2025-07-01 12:02:00 - INFO - read_and_clean_power_data - Reading 11 sheets from C:\Users\SamClissold\MCCF_Git_Repo\MCCF\PDP8\data\PDP8 project data (2).xlsx
2025-07-01 12:02:00 - INFO - read_and_clean_power_data - Processing solar sheet with 340 rows
2025-07-01 12:02:00 - INFO - read_and_clean_power_data - Filtered 0 rows with empty project names
2025-07-01 12:02:00 - INFO - read_and_clean_power_data - Found 6 unique operational phases
2025-07-01 12:02:00 - INFO - read_and_clean_power_data - Filtered 0 rows with invalid periods
2025-07-01 12:02:00 - INFO - read_and_clean_power_data - Completed processing solar sheet
2025-07-01 12:02:00 - INFO - read_and_clean_power_data - Processing onshore sheet with 197 rows
2025-07-01 12:02:00 - INFO - read_and_clean_power_data - Filtered 0 rows with empty project names
2025-07-01 12:02:00 - INFO - read_and_clean_power_data - Found 4 unique operational phases
2025-07-01 12:02:00 - INFO - read_and_clean_power_data - Filtered 0 rows with invalid periods
2025-07-01 12:02:00 - INFO - read_and_clean_power_data - Completed processing onshore sheet
2025-07-01 12:02:00 - INFO - read_and_clean_power_data - Processing LNG-fired gas sheet with 26 rows
2025-07-01 12:02:00 - INFO - read_and_clean_power_data - Filtered 0 rows with empty project names
2025-07-01 12:02:00 - INFO - read_and_clean_power_data - Found 2 unique operational phases
2025-07-01 12:02:00 - INFO - read_and_clean_power_data - Filtered 0 rows with invalid periods
2025-07-01 12:02:00 - INFO - read_and_clean_power_data - Completed processing LNG-fired gas sheet
2025-07-01 12:02:00 - INFO - read_and_clean_power_data - Processing cogeneration sheet with 8 rows
2025-07-01 12:02:00 - INFO - read_and_clean_power_data - Filtered 0 rows with empty project names
2025-07-01 12:02:00 - INFO - read_and_clean_power_data - Found 2 unique operational phases
2025-07-01 12:02:00 - INFO - read_and_clean_power_data - Filtered 0 rows with invalid periods
2025-07-01 12:02:00 - INFO - read_and_clean_power_data - Completed processing cogeneration sheet
2025-07-01 12:02:00 - INFO - read_and_clean_power_data - Processing domestic gas-fired sheet with 10 rows
2025-07-01 12:02:00 - INFO - read_and_clean_power_data - Filtered 0 rows with empty project names
2025-07-01 12:02:00 - INFO - read_and_clean_power_data - Found 1 unique operational phases
2025-07-01 12:02:00 - INFO - read_and_clean_power_data - Filtered 0 rows with invalid periods
2025-07-01 12:02:00 - INFO - read_and_clean_power_data - Completed processing domestic gas-fired sheet
2025-07-01 12:02:00 - INFO - read_and_clean_power_data - Processing hydro sheet with 12 rows
2025-07-01 12:02:00 - INFO - read_and_clean_power_data - Filtered 0 rows with empty project names
2025-07-01 12:02:00 - INFO - read_and_clean_power_data - Found 2 unique operational phases
2025-07-01 12:02:00 - INFO - read_and_clean_power_data - Filtered 0 rows with invalid periods
2025-07-01 12:02:00 - INFO - read_and_clean_power_data - Completed processing hydro sheet
2025-07-01 12:02:00 - INFO - read_and_clean_power_data - Processing pumped-storage sheet with 22 rows
2025-07-01 12:02:00 - INFO - read_and_clean_power_data - Filtered 0 rows with empty project names
2025-07-01 12:02:00 - INFO - read_and_clean_power_data - Found 2 unique operational phases
2025-07-01 12:02:00 - INFO - read_and_clean_power_data - Filtered 0 rows with invalid periods
2025-07-01 12:02:00 - INFO - read_and_clean_power_data - Completed processing pumped-storage sheet
2025-07-01 12:02:00 - INFO - read_and_clean_power_data - Processing nuclear sheet with 2 rows
2025-07-01 12:02:00 - INFO - read_and_clean_power_data - Filtered 0 rows with empty project names
2025-07-01 12:02:00 - INFO - read_and_clean_power_data - Found 1 unique operational phases
2025-07-01 12:02:00 - INFO - read_and_clean_power_data - Filtered 0 rows with invalid periods
2025-07-01 12:02:00 - INFO - read_and_clean_power_data - Completed processing nuclear sheet
2025-07-01 12:02:00 - INFO - read_and_clean_power_data - Processing biomass sheet with 29 rows
2025-07-01 12:02:00 - INFO - read_and_clean_power_data - Filtered 0 rows with empty project names
2025-07-01 12:02:00 - INFO - read_and_clean_power_data - Found 11 unique operational phases
2025-07-01 12:02:00 - INFO - read_and_clean_power_data - Filtered 0 rows with invalid periods
2025-07-01 12:02:00 - INFO - read_and_clean_power_data - Completed processing biomass sheet
2025-07-01 12:02:00 - INFO - read_and_clean_power_data - Processing waste-to-energy sheet with 9 rows
2025-07-01 12:02:00 - INFO - read_and_clean_power_data - Filtered 0 rows with empty project names
2025-07-01 12:02:00 - INFO - read_and_clean_power_data - Found 1 unique operational phases
2025-07-01 12:02:00 - INFO - read_and_clean_power_data - Filtered 4 rows with invalid periods
2025-07-01 12:02:00 - INFO - read_and_clean_power_data - Completed processing waste-to-energy sheet
2025-07-01 12:02:00 - INFO - read_and_clean_power_data - Processing flexible sheet with 3 rows
2025-07-01 12:02:00 - INFO - read_and_clean_power_data - Filtered 0 rows with empty project names
2025-07-01 12:02:00 - INFO - read_and_clean_power_data - Found 2 unique operational phases
2025-07-01 12:02:00 - INFO - read_and_clean_power_data - Filtered 0 rows with invalid periods
2025-07-01 12:02:00 - INFO - read_and_clean_power_data - Completed processing flexible sheet
2025-07-01 12:02:00 - INFO - read_and_clean_power_data - Combining all processed sheets
2025-07-01 12:02:00 - INFO - read_and_clean_power_data - Processing coordinates and capacity
2025-07-01 12:02:00 - INFO - read_and_clean_power_data - Dropped 0 rows with invalid coordinates or capacity
2025-07-01 12:02:00 - INFO - read_and_clean_power_data - Power data processing completed in 0.33 seconds
2025-07-01 12:02:00 - INFO - read_and_clean_power_data - Final dataset has 654 rows
2025-07-01 12:02:00 - INFO - save_to_cache - Saved read_and_clean_power_data data to cache
2025-07-01 12:02:00 - INFO - create_folium_map - Starting base map creation
2025-07-01 12:02:00 - INFO - create_folium_map - Adding map plugins
2025-07-01 12:02:00 - INFO - create_folium_map - Adding legend control script
2025-07-01 12:02:00 - INFO - create_folium_map - Base map creation completed in 0.00 seconds
2025-07-01 12:02:00 - INFO - add_project_layers - Starting project layer addition
2025-07-01 12:02:00 - INFO - add_project_layers - Creating feature groups
2025-07-01 12:02:00 - INFO - add_project_layers - Adding markers to map
2025-07-01 12:02:00 - INFO - add_project_layers - Added 100 markers to map
2025-07-01 12:02:00 - INFO - add_project_layers - Added 200 markers to map
2025-07-01 12:02:00 - INFO - add_project_layers - Added 300 markers to map
2025-07-01 12:02:00 - INFO - add_project_layers - Added 400 markers to map
2025-07-01 12:02:00 - INFO - add_project_layers - Added 500 markers to map
2025-07-01 12:02:00 - INFO - add_project_layers - Added 600 markers to map
2025-07-01 12:02:00 - INFO - add_project_layers - Total markers added: 654
2025-07-01 12:02:00 - INFO - save_and_open_map - Starting map saving process
2025-07-01 12:02:00 - INFO - save_and_open_map - Saving map to C:\Users\SamClissold\MCCF_Git_Repo\MCCF\PDP8\results\PDP8_power_projects_map.html
2025-07-01 12:02:00 - INFO - save_and_open_map - Opening map in browser: C:\Users\SamClissold\MCCF_Git_Repo\MCCF\PDP8\results\PDP8_power_projects_map.html
2025-07-01 12:02:01 - INFO - save_and_open_map - Map saving and opening completed in 0.47 seconds
2025-07-01 12:02:01 - INFO - main - Generating substation map
2025-07-01 12:02:01 - INFO - read_substation_data - Starting substation data reading
2025-07-01 12:02:01 - INFO - read_substation_data - Reading substation data from C:\Users\SamClissold\MCCF_Git_Repo\MCCF\PDP8\data\infrastructure_data.xlsx
2025-07-01 12:02:29 - INFO - read_substation_data - Initial data shape: (103453, 29)
2025-07-01 12:02:29 - INFO - read_substation_data - Filtered 0 rows with blank substation type
2025-07-01 12:02:29 - INFO - read_substation_data - Kept columns: ['substation_type', 'max_voltage', 'longitude', 'latitude']
2025-07-01 12:02:29 - INFO - read_substation_data - Substation data reading completed in 28.67 seconds
2025-07-01 12:02:29 - INFO - read_substation_data - Final substation records: 103453
2025-07-01 12:02:29 - INFO - save_to_cache - Saved read_substation_data data to cache
2025-07-01 12:02:29 - INFO - create_substation_map - Filtered 95016 rows with NaN voltage values
2025-07-01 12:02:29 - INFO - create_folium_map - Starting base map creation
2025-07-01 12:02:29 - INFO - create_folium_map - Adding map plugins
2025-07-01 12:02:29 - INFO - create_folium_map - Adding legend control script
2025-07-01 12:02:29 - INFO - create_folium_map - Base map creation completed in 0.01 seconds
2025-07-01 12:02:32 - INFO - save_and_open_map - Starting map saving process
2025-07-01 12:02:32 - INFO - save_and_open_map - Saving map to C:\Users\SamClissold\MCCF_Git_Repo\MCCF\PDP8\results\vn_substation_map.html
2025-07-01 12:02:55 - INFO - save_and_open_map - Opening map in browser: C:\Users\SamClissold\MCCF_Git_Repo\MCCF\PDP8\results\vn_substation_map.html
2025-07-01 12:02:55 - INFO - save_and_open_map - Map saving and opening completed in 22.68 seconds
2025-07-01 12:02:55 - INFO - main - Generating transmission map
2025-07-01 12:02:55 - INFO - read_transmission_data - Starting transmission data reading
2025-07-01 12:02:55 - INFO - read_transmission_data - Reading transmission data from C:\Users\SamClissold\MCCF_Git_Repo\MCCF\PDP8\data\infrastructure_data.xlsx
2025-07-01 12:03:28 - INFO - read_transmission_data - Initial data shape: (103453, 29)
2025-07-01 12:03:28 - INFO - read_transmission_data - Filtered 0 rows with blank location
2025-07-01 12:03:28 - INFO - read_transmission_data - Filtered 93430 rows with invalid location type
2025-07-01 12:03:28 - INFO - read_transmission_data - Kept columns: ['location', 'longitude', 'latitude', 'max_voltage']
2025-07-01 12:03:28 - INFO - read_transmission_data - Transmission data reading completed in 32.90 seconds
2025-07-01 12:03:28 - INFO - read_transmission_data - Final transmission records: 10023
2025-07-01 12:03:28 - INFO - save_to_cache - Saved read_transmission_data data to cache
2025-07-01 12:03:28 - INFO - create_transmission_map - Filtered 2465 rows with NaN voltage values
2025-07-01 12:03:28 - INFO - create_folium_map - Starting base map creation
2025-07-01 12:03:28 - INFO - create_folium_map - Adding map plugins
2025-07-01 12:03:28 - INFO - create_folium_map - Adding legend control script
2025-07-01 12:03:28 - INFO - create_folium_map - Base map creation completed in 0.02 seconds
2025-07-01 12:03:30 - INFO - save_and_open_map - Starting map saving process
2025-07-01 12:03:30 - INFO - save_and_open_map - Saving map to C:\Users\SamClissold\MCCF_Git_Repo\MCCF\PDP8\results\vn_transmission_map.html
2025-07-01 12:03:46 - INFO - save_and_open_map - Opening map in browser: C:\Users\SamClissold\MCCF_Git_Repo\MCCF\PDP8\results\vn_transmission_map.html
2025-07-01 12:03:47 - INFO - save_and_open_map - Map saving and opening completed in 17.14 seconds
2025-07-01 12:03:47 - INFO - main - Generating integrated map
2025-07-01 12:03:47 - INFO - create_folium_map - Starting base map creation
2025-07-01 12:03:47 - INFO - create_folium_map - Adding map plugins
2025-07-01 12:03:47 - INFO - create_folium_map - Adding legend control script
2025-07-01 12:03:47 - INFO - create_folium_map - Base map creation completed in 0.02 seconds
2025-07-01 12:03:47 - INFO - read_transmission_data - Starting transmission data reading
2025-07-01 12:03:47 - INFO - read_transmission_data - Reading transmission data from C:\Users\SamClissold\MCCF_Git_Repo\MCCF\PDP8\data\infrastructure_data.xlsx
2025-07-01 12:04:18 - INFO - read_transmission_data - Initial data shape: (103453, 29)
2025-07-01 12:04:18 - INFO - read_transmission_data - Filtered 0 rows with blank location
2025-07-01 12:04:18 - INFO - read_transmission_data - Filtered 93430 rows with invalid location type
2025-07-01 12:04:18 - INFO - read_transmission_data - Kept columns: ['location', 'longitude', 'latitude', 'max_voltage']
2025-07-01 12:04:18 - INFO - read_transmission_data - Transmission data reading completed in 31.64 seconds
2025-07-01 12:04:18 - INFO - read_transmission_data - Final transmission records: 10023
2025-07-01 12:04:18 - INFO - save_to_cache - Saved read_transmission_data data to cache
2025-07-01 12:04:18 - INFO - read_substation_data - Starting substation data reading
2025-07-01 12:04:18 - INFO - read_substation_data - Reading substation data from C:\Users\SamClissold\MCCF_Git_Repo\MCCF\PDP8\data\infrastructure_data.xlsx
2025-07-01 12:04:54 - INFO - read_substation_data - Initial data shape: (103453, 29)
2025-07-01 12:04:54 - INFO - read_substation_data - Filtered 0 rows with blank substation type
2025-07-01 12:04:54 - INFO - read_substation_data - Kept columns: ['substation_type', 'max_voltage', 'longitude', 'latitude']
2025-07-01 12:04:54 - INFO - read_substation_data - Substation data reading completed in 35.57 seconds
2025-07-01 12:04:54 - INFO - read_substation_data - Final substation records: 103453
2025-07-01 12:04:54 - INFO - save_to_cache - Saved read_substation_data data to cache
2025-07-01 12:04:54 - INFO - read_openinfra_existing_generators - Starting OpenInfra existing generators data reading
2025-07-01 12:04:54 - INFO - read_openinfra_existing_generators - Reading generator data from C:\Users\SamClissold\MCCF_Git_Repo\MCCF\PDP8\data\openinfra_existing_generator_data.xlsx
2025-07-01 12:04:55 - INFO - read_openinfra_existing_generators - Initial data shape: (2092, 29), Columns: ['id', 'name', 'name_en', 'operator', 'wd_operator', 'construction', 'source', 'output', 'method', 'start_date', 'longitude', 'latitude', 'wikidata', 'ref', 'location', 'max_voltage', 'voltages', 'frequency', 'circuits', 'cables', 'substation_type', 'transformer', 'v_primary', 'v_secondary', 'v_tertiary', 'rating', 'type', 'transition', 'substance']
2025-07-01 12:04:55 - INFO - read_openinfra_existing_generators - Kept and renamed 4 required columns
2025-07-01 12:04:55 - INFO - read_openinfra_existing_generators - OpenInfra existing generators data reading completed in 0.57 seconds
2025-07-01 12:04:55 - INFO - read_openinfra_existing_generators - Final generator records: 2092
2025-07-01 12:04:55 - INFO - save_to_cache - Saved read_openinfra_existing_generators data to cache
2025-07-01 12:04:55 - ERROR - main - Error creating map: 'voltage'
Traceback (most recent call last):
  File "C:\Users\SamClissold\anaconda3\envs\mccf-env\lib\site-packages\pandas\core\indexes\base.py", line 3812, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 167, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 196, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 7088, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 7096, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'voltage'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "C:\Users\SamClissold\MCCF_Git_Repo\MCCF\PDP8\map.py", line 2446, in main
    m = create_integrated_map(force_recompute=args.force_recompute)
  File "C:\Users\SamClissold\MCCF_Git_Repo\MCCF\PDP8\map.py", line 1466, in create_integrated_map
    for voltage in transmission_df['voltage'].unique():
  File "C:\Users\SamClissold\anaconda3\envs\mccf-env\lib\site-packages\pandas\core\frame.py", line 4107, in __getitem__
    indexer = self.columns.get_loc(key)
  File "C:\Users\SamClissold\anaconda3\envs\mccf-env\lib\site-packages\pandas\core\indexes\base.py", line 3819, in get_loc
    raise KeyError(key) from err
KeyError: 'voltage'
