2025-07-01 14:02:12 - INFO - setup_logging - Logging initialized. Log file: C:\Users\SamClissold\MCCF_GIT_Repo - Copy\MCCF\PDP8\results\logs\map_generation_20250701_140212.log
2025-07-01 14:02:12 - INFO - main - Starting map generation process
2025-07-01 14:02:12 - INFO - main - Generating map type: integrated
2025-07-01 14:02:12 - INFO - main - Generating integrated map
2025-07-01 14:02:12 - INFO - get_power_lines - Reading powerline data from C:\Users\SamClissold\MCCF_GIT_Repo - Copy\MCCF\PDP8\data\VNM.gpkg
2025-07-01 14:02:12 - INFO - get_power_lines - Read 10023 powerline records
2025-07-01 14:02:12 - INFO - cache_polylines - Loading polylines from cache: C:\Users\SamClissold\MCCF_GIT_Repo - Copy\MCCF\PDP8\results\powerline_polylines.geojson
2025-07-01 14:02:12 - INFO - load_from_cache - Loaded read_substation_data data from cache
2025-07-01 14:02:12 - INFO - load_from_cache - Loaded read_and_clean_power_data data from cache
2025-07-01 14:02:12 - INFO - load_from_cache - Loaded read_planned_transformer_data data from cache
2025-07-01 14:02:12 - ERROR - main - Error creating map: 'voltage_cat'
Traceback (most recent call last):
  File "C:\Users\SamClissold\anaconda3\envs\mccf-env\lib\site-packages\pandas\core\indexes\base.py", line 3812, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 167, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 196, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 7088, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 7096, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'voltage_cat'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "C:\Users\SamClissold\MCCF_GIT_Repo - Copy\MCCF\PDP8\map.py", line 2841, in main
    m = create_integrated_map(force_recompute=args.force_recompute)
  File "C:\Users\SamClissold\MCCF_GIT_Repo - Copy\MCCF\PDP8\map.py", line 1868, in create_integrated_map
    transformer_df['voltage_cat'] = transformer_df['voltage_cat'].apply(voltage_category)
  File "C:\Users\SamClissold\anaconda3\envs\mccf-env\lib\site-packages\pandas\core\frame.py", line 4107, in __getitem__
    indexer = self.columns.get_loc(key)
  File "C:\Users\SamClissold\anaconda3\envs\mccf-env\lib\site-packages\pandas\core\indexes\base.py", line 3819, in get_loc
    raise KeyError(key) from err
KeyError: 'voltage_cat'
