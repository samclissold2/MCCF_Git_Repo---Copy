2025-07-01 11:43:47 - INFO - setup_logging - Logging initialized. Log file: C:\Users\SamClissold\MCCF_Git_Repo\MCCF\PDP8\results\logs\map_generation_20250701_114347.log
2025-07-01 11:43:47 - INFO - main - Starting map generation process
2025-07-01 11:43:47 - INFO - main - Generating map type: substation
2025-07-01 11:43:47 - INFO - main - Generating substation map
2025-07-01 11:43:47 - INFO - read_substation_data - Starting substation data reading
2025-07-01 11:43:47 - INFO - read_substation_data - Reading substation data from C:\Users\SamClissold\MCCF_Git_Repo\MCCF\PDP8\data\infrastructure_data.xlsx
2025-07-01 11:43:54 - INFO - read_substation_data - Initial data shape: (103453, 29)
2025-07-01 11:43:54 - INFO - read_substation_data - Filtered 0 rows with blank substation type
2025-07-01 11:43:54 - INFO - read_substation_data - Kept columns: ['substation_type', 'max_voltage', 'longitude', 'latitude']
2025-07-01 11:43:54 - INFO - read_substation_data - Substation data reading completed in 7.03 seconds
2025-07-01 11:43:54 - INFO - read_substation_data - Final substation records: 103453
2025-07-01 11:43:54 - INFO - save_to_cache - Saved read_substation_data data to cache
2025-07-01 11:43:54 - INFO - create_folium_map - Starting base map creation
2025-07-01 11:43:54 - INFO - create_folium_map - Adding map plugins
2025-07-01 11:43:54 - INFO - create_folium_map - Adding legend control script
2025-07-01 11:43:54 - INFO - create_folium_map - Base map creation completed in 0.02 seconds
2025-07-01 11:43:54 - ERROR - main - Error creating map: nan
Traceback (most recent call last):
  File "C:\Users\SamClissold\MCCF_Git_Repo\MCCF\PDP8\map.py", line 2384, in main
    m = create_substation_map(force_recompute=args.force_recompute)
  File "C:\Users\SamClissold\MCCF_Git_Repo\MCCF\PDP8\map.py", line 1370, in create_substation_map
    ).add_to(voltage_groups[voltage])
KeyError: nan
